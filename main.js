(()=>{var e={104:e=>{var t="undefined"!=typeof process&&process.pid?process.pid.toString(36):"";function s(){var e=Date.now(),t=s.last||e;return s.last=e>t?e:t+1}e.exports=e.exports.default=function(e,r){return(e||"")+""+t+s().toString(36)+(r||"")},e.exports.process=function(e,r){return(e||"")+t+s().toString(36)+(r||"")},e.exports.time=function(e,t){return(e||"")+s().toString(36)+(t||"")}}},t={};function s(r){var d=t[r];if(void 0!==d)return d.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,s),i.exports}s.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return s.d(t,{a:t}),t},s.d=(e,t)=>{for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";class e{list(e){}get(e,t){}create(e,t){}update(e,t,s){}delete(e,t){}}var t=s(104),r=s.n(t);const d=document.getElementById("root");new class{constructor(t){if(!(t instanceof HTMLElement))throw new Error("This is not HTML element!");this.url="http://localhost:3000/",this.container=t,this.ticketService=new e}init(){this.renderField(),this.openForms(),this.redrawAllTickets()}renderField(){this.field=document.createElement("div"),this.field.classList.add("field");const e=document.createElement("div");e.classList.add("header");const t=document.createElement("button");t.classList.add("add-button"),t.classList.add("btn"),t.innerText="–î–æ–±–∞–≤–∏—Ç—å —Ç–∏–∫–µ—Ç",e.appendChild(t);const s=document.createElement("ul");s.classList.add("ticket-list"),this.field.appendChild(e),this.field.appendChild(s),document.querySelector("body").appendChild(this.field),this.addForm=document.createElement("form"),this.addForm.classList.add("add-form"),this.addForm.classList.add("modal"),this.addForm.innerHTML="<div class = 'form-header-wrapper'> <h3 class = 'form-header'> –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–∫–µ—Ç </h3></div>",this.addForm.innerHTML+="<div class = 'input-wrapper'> <h4 class = 'input-header'> –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ </h4> <input class = 'form-input' id = 'short-desc'>  </div>",this.addForm.innerHTML+="<div class = 'input-wrapper'> <h4 class = 'input-header'> –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ </h4> <textarea id = 'full-desc'> </textarea></div>",this.addForm.innerHTML+="<div class = 'btn-group'> <button class = 'btn cancel-button'> –û—Ç–º–µ–Ω–∞ </button> <button class = 'btn ok-button'> OK </button></div>",this.addForm.querySelector(".cancel-button").addEventListener("click",(e=>{e.preventDefault(),e.target.closest(".modal").remove()})),this.addForm.querySelector(".ok-button").addEventListener("click",(e=>{e.preventDefault(),this.addNewTicket(),e.target.closest(".modal").remove()}))}showAddForm(){document.querySelector(".field").appendChild(this.addForm)}showRemoveForm(e){this.removeForm=document.createElement("div"),this.removeForm.classList.add("remove-form"),this.removeForm.classList.add("modal"),this.removeForm.innerHTML="<div class = 'form-header-wrapper'> <h3 class = 'form-header'> –£–¥–∞–ª–∏—Ç—å —Ç–∏–∫–µ—Ç </h3></div>",this.removeForm.innerHTML+="<div class = 'remove-form-wrapper'> –í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Ç–∏–∫–µ—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ. </div>",this.removeForm.innerHTML+="<div class = 'btn-group'> <button class = 'btn cancel-button'> –û—Ç–º–µ–Ω–∞ </button> <button class = 'btn ok-button'> OK </button></div>",document.querySelector(".field").appendChild(this.removeForm),this.removeForm.querySelector(".ok-button").addEventListener("click",(t=>{t.preventDefault();const s=new XMLHttpRequest;s.open("POST",`${this.url}?deleteById&id=${e.id}`,!0),s.send(e.id),e.remove(),this.removeForm.remove()})),this.removeForm.querySelector(".cancel-button").addEventListener("click",(e=>{e.preventDefault(),this.removeForm.remove()}))}showEditForm(e){this.editForm=document.createElement("form"),this.editForm.classList.add("edit-form"),this.editForm.classList.add("modal"),this.editForm.innerHTML="<div class = 'form-header-wrapper'> <h3 class = 'form-header'> –ò–∑–º–µ–Ω–∏—Ç—å —Ç–∏–∫–µ—Ç </h3></div>",this.editForm.innerHTML+=`<div class = 'input-wrapper'> <h4 class = 'input-header'> –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ </h4> <input class = 'form-input' id = 'short-desc' value = ${e.querySelector(".ticket-short-desc").innerText}></div>`,this.editForm.innerHTML+=`<div class = 'input-wrapper'> <h4 class = 'input-header'> –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ </h4> <textarea id = 'full-desc' > ${e.querySelector(".ticket-full-desc").innerText} </textarea></div>`,this.editForm.innerHTML+="<div class = 'btn-group'> <button class = 'btn cancel-button'> –û—Ç–º–µ–Ω–∞ </button> <button class = 'btn ok-button'> OK </button></div>",document.querySelector(".field").appendChild(this.editForm),this.editForm.querySelector(".ok-button").addEventListener("click",(t=>{t.preventDefault();const s=document.getElementById("short-desc").value;e.querySelector(".ticket-short-desc").innerText=s;const r=document.getElementById("full-desc").value;e.querySelector(".ticket-full-desc").innerText=r;let d="false";e.querySelector(".ticket-status").classList.contains("ready")&&(d="true");const{created:i}=e.dataset,n=new FormData;n.append("name",s),n.append("description",r),n.append("status",d),n.append("created",i),n.append("id",e.id);const o=new XMLHttpRequest;o.open("POST",`${this.url}?method=updateById&id=${e.id}`,!0),o.send(n),this.editForm.remove()})),this.editForm.querySelector(".cancel-button").addEventListener("click",(e=>{e.preventDefault(),this.editForm.remove()}))}createTicket(e,t,s,r){const d=document.createElement("li");d.classList.add("ticket");const i=`${new Date(r).toLocaleDateString()}, ${new Date(r).toLocaleTimeString()}`;return d.innerHTML=`<div class = 'ticket-header'> <div class = 'ticket-status ${s}'></div> <div class = 'ticket-short-desc'> ${e}</div><div class = 'ticket-time'> ${i} </div> <div class = 'edit-ticket'> </div> <div class ='remove-ticket'> </div> </div> <div class = 'ticket-full-desc'> ${t} </div>`,d.querySelector(".ticket-status").addEventListener("click",(e=>{console.log("üöÄ ~ file: HelpDesk.js:127 ~ HelpDesk ~ ticket.querySelector ~ evt:",e);const t=new XMLHttpRequest;t.open("POST",`${this.url}?method=createTicket=${d.id}`,!0),t.send(d.id),e.target.classList.contains("unready")?(e.target.classList.remove("unready"),e.target.classList.add("ready")):(e.target.classList.remove("ready"),e.target.classList.add("unready"))})),d.querySelector(".ticket-short-desc").addEventListener("click",(e=>{!1===e.target.closest(".ticket").querySelector(".ticket-full-desc").classList.contains("visible")?e.target.closest(".ticket").querySelector(".ticket-full-desc").classList.add("visible"):e.target.closest(".ticket").querySelector(".ticket-full-desc").classList.remove("visible")})),d.querySelector(".remove-ticket").addEventListener("click",(()=>{this.showRemoveForm(d)})),d.querySelector(".edit-ticket").addEventListener("click",(()=>{this.showEditForm(d)})),d}openForms(){document.querySelector(".add-button").addEventListener("click",(e=>{e.preventDefault(),this.showAddForm()}))}addNewTicket(){const e=document.getElementById("short-desc").value,t=document.getElementById("full-desc").value;if(!e||!t)return!1;const s=r()(),d=new FormData,i=Date.now();d.append("name",e),d.append("description",t),d.append("status","false"),d.append("created",i),d.append("id",s);const n=new XMLHttpRequest;n.open("POST",`${this.url}?method=createTicket`,!0),n.send(d);const o=this.createTicket(e,t,"unready",i);return o.id=s,o.dataset.created=i,document.querySelector(".ticket-list").appendChild(o),!1}redrawAllTickets(){const e=new XMLHttpRequest;e.open("GET",`${this.url}?method=allTickets`,!0),e.addEventListener("readystatechange",(()=>{if(4===e.readyState){const t=JSON.parse(e.response);for(const e of t){let t;"true"===e.status&&(t="ready"),"false"===e.status&&(t="unready");const s=this.createTicket(e.name,e.description,t,new Date(Number(e.created)));s.id=e.id,s.dataset.created=e.created,document.querySelector("ul").appendChild(s)}}})),e.send()}}(d).init()})()})();